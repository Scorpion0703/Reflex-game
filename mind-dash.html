<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mind Dash • Reflex</title>

<link rel="manifest" href="/Reflex-game/site.webmanifest">
<meta name="theme-color" content="#0f1220">
<link rel="apple-touch-icon" href="/Reflex-game/icons/icon-180.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
:root{
  --bg:#0f1220; --panel:#151a2f; --accent:#6ee7ff; --muted:#9aa4b2; 
  --ok:#2ecc71; --warn:#ffb020; --bad:#ff5c5c;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background:radial-gradient(1300px 800px at 70% -10%, #1a1f3d 0%, var(--bg) 60%);
  color:#e8eef7; font:16px/1.45 system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  display:flex; align-items:center; justify-content:center; padding:20px;
}
.app{
  width:min(980px,100%); background:linear-gradient(180deg,#171c34 0%, var(--panel) 100%);
  border:1px solid #1f2747; border-radius:18px; box-shadow:0 20px 60px rgba(0,0,0,.45);
  padding:18px; display:grid; gap:14px; grid-template-columns:340px 1fr; position:relative;
}
h1{margin:0 0 4px; font-size:28px}
.sub{color:var(--muted); margin-top:-2px}
.pill{display:inline-block; padding:4px 8px; border-radius:999px; border:1px solid #2a3565; margin-left:8px; color:#b8c3d6}

.controls{display:grid; gap:10px}
.row{display:flex; gap:10px; flex-wrap:wrap}
select,button,input[type="range"]{
  appearance:none; border:1px solid #273157; background:#0f1430; color:#e8eef7;
  padding:10px 12px; border-radius:12px; font-weight:600; letter-spacing:.2px;
}
button.primary{background:linear-gradient(180deg,#1d2a67,#122055); border-color:#2c3c7c}
button:disabled{opacity:.6; cursor:not-allowed}

.statgrid{display:grid; grid-template-columns:repeat(3,1fr); gap:8px}
.stat{background:#0f1430; border:1px solid #1f2747; padding:10px 12px; border-radius:12px}
.stat b{display:block; font-size:18px; margin-bottom:2px}

.stage{
  grid-column:1 / -1; position:relative; min-height:430px; border-radius:16px;
  border:1px dashed #26305a; background:#0e1227; overflow:hidden; display:grid; place-items:center;
}
#fx{position:absolute; inset:0; pointer-events:none; z-index:1}
.cardQ{
  z-index:2; display:grid; place-items:center; gap:12px; text-align:center;
}
.question{
  min-width:60%; padding:18px 22px; border-radius:14px; font-size:clamp(22px,4.2vmin,36px);
  background:#0f1430; border:1px solid #25315f; box-shadow:0 12px 40px rgba(0,0,0,.35);
}
.timer{
  width:min(540px,90%); height:10px; background:#0b1130; border:1px solid #22305c; border-radius:999px;
  overflow:hidden; margin:6px auto 0; position:relative;
}
.timer>div{
  height:100%; width:100%; background:linear-gradient(90deg, var(--ok), #65f0c0);
  transform-origin:left center; transform:scaleX(1);
  transition:transform .05s linear;
}
.actions{display:flex; gap:12px; justify-content:center}
.actionBtn{
  min-width:120px; padding:12px 16px; border-radius:12px; font-weight:800; font-size:18px; cursor:pointer;
  border:1px solid #2a3565; background:#111846; transition:transform .12s ease, background .2s;
}
.actionBtn:active{transform:scale(.98)}
.true{background:#12381f; border-color:#1c5c33}
.false{background:#3a1420; border-color:#6a2036}

#log{background:rgba(0,0,0,.25); border:1px solid rgba(255,255,255,.08); padding:12px; border-radius:10px;
     height:170px; overflow:auto; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:13px;
     color:#d1d9e6; backdrop-filter:blur(8px); box-shadow:inset 0 0 10px rgba(0,0,0,.2)}
.entry{display:flex; align-items:center; gap:8px; padding:4px 0; opacity:0; animation:fadeIn .25s forwards}
.entry .dot{width:8px; height:8px; border-radius:50%; background:#4dd2a7; box-shadow:0 0 8px #4dd2a7}
.entry.fail .dot{background:#ff6b6b; box-shadow:0 0 8px #ff6b6b}
.entry .time{color:#8ab4ff}
@keyframes fadeIn{to{opacity:1}}

.settingsBtn{margin-left:8px; border-radius:12px}
</style>
</head>

<body>
  <div class="app">
    <div>
      <h1>Mind Dash <span class="pill">Reflex</span></h1>
      <div class="sub">
        Entscheide superschnell, ob die Aussage stimmt.
      </div>

      <div class="controls">
        <div class="row">
          <button id="startBtn" class="primary">Start</button>
          <button id="resetBtn">Reset</button>
        </div>

        <div class="statgrid">
          <div class="stat"><b id="statRound">0/20</b><span>Runde</span></div>
          <div class="stat"><b id="statScore">0</b><span>Punkte</span></div>
          <div class="stat"><b id="statAvg">–</b><span>Ø Reaktion</span></div>
        </div>

        <div class="stat">
          <b>Log</b>
          <div id="log"></div>
        </div>
      </div>
    </div>

    <div class="stage">
      <canvas id="fx"></canvas>
      <div class="cardQ">
        <div id="q" class="question">Bereit?</div>
        <div class="timer"><div id="bar"></div></div>
        <div class="actions">
          <button id="btnTrue"  class="actionBtn true">✅ Stimmt</button>
          <button id="btnFalse" class="actionBtn false">❌ Falsch</button>
        </div>
      </div>
    </div>
  </div>

<script>
(()=>{

// ===== Game State =====
let round = 0, rounds = 20;
let score = 0;
let results = [];
let running = false;
let timeLimit = 800;
let startTime = 0;
let timer;

// ===== UI =====
const q = document.getElementById("q");
const bar = document.getElementById("bar");
const statRound = document.getElementById("statRound");
const statScore = document.getElementById("statScore");
const statAvg = document.getElementById("statAvg");
const logEl = document.getElementById("log");
const btnT = document.getElementById("btnTrue");
const btnF = document.getElementById("btnFalse");

// ===== Helpers =====
const fmt = ms => `${ms.toFixed(0)}ms`;
const avg = arr => arr.length ? arr.reduce((a,b)=>a+b,0)/arr.length : 0;
function addLog(t,cl=""){
  const div=document.createElement("div");
  div.className=`entry ${cl}`;
  div.innerHTML=`<span class="dot"></span> <span class="time">${new Date().toLocaleTimeString()}</span> <span>${t}</span>`;
  logEl.appendChild(div);
  logEl.scrollTop=logEl.scrollHeight;
}
function updateStats(){
  statRound.textContent=`${round}/${rounds}`;
  statScore.textContent=score;
  statAvg.textContent = results.length ? fmt(avg(results)) : "–";
}

// ===== Math question generator =====
function makeStatement(){
  const ops = ["+","-","×"];
  const a = 1+Math.floor(Math.random()*12);
  const b = 1+Math.floor(Math.random()*12);
  const op = ops[Math.floor(Math.random()*ops.length)];
  let correct = op==="+"? a+b : op==="-"? a-b : a*b;
  const real = Math.random()<0.6;
  let shown = real ? correct : correct + (Math.random()<.5?-1:1)*(1+Math.floor(Math.random()*3));
  if(shown===correct && !real) shown++;
  return {text:`${a} ${op} ${b} = ${shown}`, ans: real};
}

// ===== Game flow =====
function start(){
  round = 0; score = 0; results=[];
  running = true;
  addLog("Start!");
  nextRound();
}

function nextRound(){
  if(round >= rounds){ finish(); return; }
  round++; updateStats();

  const st = makeStatement();
  q.textContent = st.text;

  startTime = performance.now();
  bar.style.transform = "scaleX(1)";

  function tick(){
    let dt = performance.now()-startTime;
    let f = Math.max(0, 1 - dt/timeLimit);
    bar.style.transform = `scaleX(${f})`;
    if(dt>=timeLimit){
      addLog("Zeit abgelaufen","fail");
      nextRound();
    } else {
      timer = requestAnimationFrame(tick);
    }
  }
  tick();

  btnT.onclick = ()=>respond(true, st);
  btnF.onclick = ()=>respond(false, st);
}

function respond(choice, st){
  cancelAnimationFrame(timer);
  const rt = performance.now()-startTime;
  if(choice === st.ans){
    score++; results.push(rt);
    addLog(`✔ Richtig • ${fmt(rt)}`);
  } else {
    if(score>0) score--;
    addLog(`✖ Falsch`,"fail");
  }
  updateStats();
  setTimeout(nextRound, 400);
}

function finish(){
  running=false;
  addLog(`Ende • Score ${score} • ${results.length?fmt(avg(results)):"–"}`);
  q.textContent="Fertig";
}

// ===== Buttons =====
document.getElementById("startBtn").onclick=()=>!running&&start();
document.getElementById("resetBtn").onclick=()=>{
  round=0;score=0;results=[];running=false;bar.style.transform="scaleX(1)";
  q.textContent="Bereit?";logEl.innerHTML="";updateStats();
};

})();
</script>

</body>
</html>
